(this.webpackJsonpgameboard=this.webpackJsonpgameboard||[]).push([[0],{102:function(e,t,a){},104:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},108:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){},131:function(e,t){},132:function(e,t){},133:function(e,t){},151:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(78),o=a.n(c),l=a(15),i={REGION:"us-west-2",BUCKET:"gameboard-uploads"},s={REGION:"us-west-2",URL:"https://k6r2pgn41j.execute-api.us-west-2.amazonaws.com/prod"},u={REGION:"us-west-2",USER_POOL_ID:"us-west-2_55lKkN867",APP_CLIENT_ID:"1jtkpri800074n0e9amfsekbja",IDENTITY_POOL_ID:"us-west-2:d02cca9d-cd85-4f92-87bb-4e0ca6b75fdc"},d=(a(102),a(12)),m=a.n(d),p=a(51),f=a(22),g=a(5),b=(a(104),a(49)),v=(a(161),a(79)),h=a(47),E=a(80),O=a(48);a(105);var w=function(e){return r.a.createElement("div",{className:"tray"},r.a.createElement("div",{className:"edit-icon"},r.a.createElement(v.a,{onClick:e.toggleTokens})),r.a.createElement("div",{className:"edit-icon"},r.a.createElement(h.a,{onClick:e.toggleMaps})),r.a.createElement("div",{className:"edit-icon"},r.a.createElement(O.a,{onClick:e.close})),r.a.createElement("div",{className:"edit-icon"},r.a.createElement(E.a,{onClick:e.toggleOptions})))},j=a(40),S=a(38),k=a(39),y=a(43),C=a(42),I=function(e){Object(y.a)(a,e);var t=Object(C.a)(a);function a(){var e;Object(S.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).drag=function(e){e.dataTransfer.setData("transfer",e.target.src)},e.noAllowDrop=function(e){e.stopPropagation()},e}return Object(k.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{id:this.props.id,draggable:"true",onDragStart:this.drag,onDragOver:this.noAllowDrop},this.props.children)}}]),a}(r.a.Component),x=function(e){Object(y.a)(a,e);var t=Object(C.a)(a);function a(){return Object(S.a)(this,a),t.apply(this,arguments)}return Object(k.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{id:this.props.id,onDrop:this.props.drop,onDragOver:this.props.allowDrop},this.props.children)}}]),a}(r.a.Component);a(106);var D=function(e){var t="token-drawer";return t="drawerDocked"===e.state?"token-drawer docked":"token-drawer",r.a.createElement("div",{className:t},r.a.createElement("form",{action:"/action_page.php",className:"token-form"},r.a.createElement("label",{for:"token-input"},r.a.createElement("div",{className:"add-icon"},r.a.createElement(j.a,null))),r.a.createElement("input",{id:"token-input",type:"file",onChange:e.getToken})),r.a.createElement("div",{className:"token-container"},e.tokens[0]?e.tokens.map((function(e,t){return r.a.createElement("div",{className:"token-img"},r.a.createElement(x,{id:t+"droppable"},r.a.createElement(I,{id:t+"token"},r.a.createElement("img",{alt:"...",draggable:"true",src:e.src,width:"100",height:"100"}))))})):r.a.createElement("p",null,"Add a token. Drag and drop the token onto the grid. Scale token to grid by double clicking the token.")))};a(107);var N=function(e){var t="map-drawer";return t="drawerOpen"===e.state?"map-drawer open":"map-drawer",r.a.createElement("div",{className:t},r.a.createElement("form",{action:"/action_page.php",className:"map-form"},r.a.createElement("label",{for:"file-input"},r.a.createElement("div",{className:"add-icon"},r.a.createElement(j.a,null))),r.a.createElement("input",{id:"file-input",type:"file",onChange:e.getMap})),r.a.createElement("div",{className:"map-container"},e.maps[0]?e.maps.map((function(t,a){return r.a.createElement("img",{src:t.src,alt:"...",id:a+"map",width:"100",height:"50",onClick:e.changeMap})})):r.a.createElement("p",null,"Add a map. Switch maps by clicking on the thumbnails.")))};a(108);var T=function(e){return r.a.createElement("div",{className:"options"},r.a.createElement("div",null,"Grid Size"),r.a.createElement("div",null,r.a.createElement("input",{type:"range",min:"10",max:"100",class:"slider",onInput:e.scaleGrid.bind(this)})),r.a.createElement("div",null,"Map Size"),r.a.createElement("div",null,r.a.createElement("input",{type:"range",min:"10",max:"100",class:"slider",onInput:e.scaleMap.bind(this)})),r.a.createElement("div",null,r.a.createElement("div",{className:"logout-button",onClick:e.handleLogout.bind(this)},r.a.createElement("span",null,"Log Out"))))};a(109);var P=function(e){var t=Object(n.useState)(null),a=Object(g.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(null),i=Object(g.a)(l,2),s=i[0],u=i[1];return r.a.createElement("div",{className:"login-page"},r.a.createElement("div",{className:"title"},r.a.createElement("h1",null,"Battlemaps")),r.a.createElement("div",{className:"login-form"},r.a.createElement("form",{onSubmit:function(t){e.handleSubmit(c,s),t.preventDefault()}},r.a.createElement("input",{autoFocus:!0,type:"email",value:c,placeholder:"Email",onChange:function(e){return o(e.target.value)}}),r.a.createElement("input",{value:s,placeholder:"Password",onChange:function(e){return u(e.target.value)},type:"password"}),r.a.createElement("button",{block:!0,bsSize:"large",disabled:!function(){if(c&&s)return c.length>0&&s.length>0}(),type:"submit"},"Login")),r.a.createElement("div",null,"Dont have an account?",r.a.createElement("button",{onClick:e.signUp},"Sign up here"),"or",r.a.createElement("button",{onClick:e.runTest},"Test without signing up"))))};a(110);function L(e){var t=Object(n.useState)(null),a=Object(g.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),i=Object(g.a)(l,2),s=(i[0],i[1]),u=Object(n.useState)(null),d=Object(g.a)(u,2),p=d[0],v=d[1],h=Object(n.useState)(null),E=Object(g.a)(h,2),O=E[0],w=E[1],j=Object(n.useState)(null),S=Object(g.a)(j,2),k=S[0],y=S[1],C=Object(n.useState)(null),I=Object(g.a)(C,2),x=I[0],D=I[1];function N(e){return T.apply(this,arguments)}function T(){return(T=Object(f.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),O===k){e.next=4;break}return alert("Passwords do not match"),e.abrupt("return");case 4:return s(!0),e.prev=5,e.next=8,b.a.signUp({username:p,password:O});case 8:a=e.sent,s(!1),o(a),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),alert(e.t0.message),s(!1);case 17:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}function P(e){return L.apply(this,arguments)}function L(){return(L=Object(f.a)(m.a.mark((function t(a){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),s(!0),t.prev=2,t.next=5,b.a.confirmSignUp(p,x);case 5:return t.next=7,b.a.signIn(p,O);case 7:e.confirmSignUp(),e.userHasAuthenticated(!0),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),alert(t.t0.message),s(!1);case 15:case"end":return t.stop()}}),t,null,[[2,11]])})))).apply(this,arguments)}return r.a.createElement("div",{className:"signup-page"},null===c?r.a.createElement("div",{className:"signup-card"},r.a.createElement("form",{onSubmit:N,className:"signup-form"},r.a.createElement("label",null,"Email"),r.a.createElement("input",{autoFocus:!0,type:"email",onChange:function(e){return v(e.target.value)}}),r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",onChange:function(e){return w(e.target.value)}}),r.a.createElement("label",null,"Confirm Password"),r.a.createElement("input",{type:"password",onChange:function(e){return y(e.target.value)}}),r.a.createElement("button",null,"Submit"))):r.a.createElement("form",{onSubmit:P},r.a.createElement("label",null,"Confirmation Code"),r.a.createElement("input",{autoFocus:!0,type:"tel",onChange:function(e){return D(e.target.value)}}),r.a.createElement("button",null,"Submit"),r.a.createElement("h1",null,"Please check your email for the code.")))}var A=a(21);var M=function(e){var t=Object(n.useState)(null),a=Object(g.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(null),i=Object(g.a)(l,2),s=i[0],u=i[1],d=Object(n.useState)(null),m=Object(g.a)(d,2),p=m[0],f=m[1],b=Object(n.useState)(null),v=Object(g.a)(b,2),h=v[0],E=v[1];function O(e,t){var a=document.body.clientWidth,n=document.body.clientHeight,r=e.getObjects("line");for(var c in r)e.remove(r[c]);for(var o=0;o<n/t;o++)e.add(new A.fabric.Line([0,o*t,a,o*t],{stroke:"grey",selectable:!1}));for(var l=0;l<a/t;l++)e.add(new A.fabric.Line([l*t,0,l*t,n],{stroke:"grey",selectable:!1}))}function w(t){if(t){var a=e.mapScale,n=document.body.clientWidth,r=document.body.clientHeight;if(t){var o=n/2-t.width/2*a,l=r/2-t.height/2*a;A.fabric.Image.fromURL(t.src,(function(e){var t=e.set({left:o,top:l,selectable:!1}).scale(a);c.setBackgroundImage(t),c.renderAll()}))}}}function j(e,t){e.off(),e.on("object:moving",(function(e){e.target.left=Math.round(e.target.left/t)*t,e.target.top=Math.round(e.target.top/t)*t,e.target.setCoords()})),e.on("mouse:dblclick",(function(a){e.getActiveObject().scaleToWidth(t),e.getActiveObject().scaleToHeight(t),e.renderAll()}))}function S(){var e=document.createElement("img");return e.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E",function(t,a,n,r,c){var o=this.cornerSize;t.save(),t.translate(a,n),t.rotate(A.fabric.util.degreesToRadians(c.angle)),t.drawImage(e,-o/2,-o/2,o,o),t.restore()}}function k(e,t){var a=t.canvas;a.remove(t),a.requestRenderAll()}return Object(n.useEffect)((function(){!function(){if(c)e.gridScale!==h&&(j(c,e.gridScale),O(c,e.gridScale),E(e.gridScale)),e.currentMap!==s|e.mapScale!==p&&(w(e.currentMap),u(e.currentMap),f(e.mapScale));else{var t=new A.fabric.Canvas("canvas",{selection:!1});o(t),j(t,e.gridScale),O(t,e.gridScale),w(e.currentMap),A.fabric.Object.prototype.controls.deleteControl=new A.fabric.Control({x:.5,y:-.5,offsetY:-16,offsetX:16,cursorStyle:"pointer",mouseUpHandler:k,render:S(),cornerSize:24}),E(e.gridScale),f(e.mapScale),u(e.currentMap)}}()}),[e.currentMap,e.gridScale,e.mapScale]),r.a.createElement(x,{drop:function(t){t.preventDefault();var a=t.dataTransfer.getData("transfer"),n=new Image;n.src=a;var r=t.clientX,o=t.clientY;!function(t,a,n){A.fabric.Image.fromURL(t.src,(function(t){var r=t.set({left:a,top:n});r.scaleToWidth(e.gridScale),r.scaleToHeight(e.gridScale),c.add(r)}))}(n,r,o)},allowDrop:function(e){e.preventDefault()}},r.a.createElement("canvas",{id:"canvas",width:document.body.clientWidth,height:document.body.clientHeight}))};var U=function(e){var t=Object(n.useState)("drawerClosed"),a=Object(g.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)("drawerClosed"),i=Object(g.a)(l,2),s=i[0],u=i[1],d=Object(n.useState)(!1),v=Object(g.a)(d,2),h=v[0],E=v[1],O=Object(n.useState)([]),j=Object(g.a)(O,2),S=j[0],k=j[1],y=Object(n.useState)([]),C=Object(g.a)(y,2),I=C[0],x=C[1],A=Object(n.useState)(null),U=Object(g.a)(A,2),R=U[0],_=U[1],G=Object(n.useState)(1),W=Object(g.a)(G,2),B=W[0],F=W[1],H=Object(n.useState)(50),z=Object(g.a)(H,2),Y=z[0],K=z[1],J=Object(n.useState)(!1),V=Object(g.a)(J,2),X=V[0],q=V[1],$=Object(n.useState)(!0),Q=Object(g.a)($,2),Z=(Q[0],Q[1],Object(n.useState)(!1)),ee=Object(g.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(g.a)(ne,2),ce=(re[0],re[1]);function oe(){return(oe=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.currentSession();case 3:ue(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),"No current user"!==e.t0&&alert(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function le(){return(le=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.signIn(t,a);case 3:ue(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function ie(){return(ie=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.signOut();case 2:ae(!1);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){q(!1)}function ue(){ae(!0)}function de(){"drawerOpen"===s&&me(),o("drawerClosed"===c?"drawerDocked":"drawerClosed")}function me(){"drawerDocked"===c&&de(),u("drawerClosed"===s?"drawerOpen":"drawerClosed")}return Object(n.useEffect)((function(){!function(){oe.apply(this,arguments)}()}),[]),r.a.createElement("div",{className:"App"},X&&r.a.createElement(L,{userHasAuthenticated:ae,confirmSignUp:se}),te?r.a.createElement(M,{gridScale:Y,currentMap:R,mapScale:B}):r.a.createElement(P,{runTest:function(){ae(!0),ce(!0)},authenticateLogin:ue,signUp:function(){q(!0)},confirmSignUp:se,handleSubmit:function(e,t){return le.apply(this,arguments)}}),h&&r.a.createElement(T,{scaleGrid:function(e){var t=parseInt(e.target.value);K(t)},scaleMap:function(e){var t=e.target.value/50;F(t)},handleLogout:function(){return ie.apply(this,arguments)}}),r.a.createElement(w,{toggleTokens:de,toggleMaps:me,toggleOptions:function(){E(!h)},close:function(){E(!1),o("drawerClosed"),u("drawerClosed")}}),r.a.createElement(D,{state:c,getToken:function(e){for(var t=e.target.files,a=t.length,n=function(e){var a=new FileReader,n=t[e];a.onloadend=function(){var e=new Image;e.src=a.result,x((function(t){return[].concat(Object(p.a)(t),[e])}))},a.readAsDataURL(n)},r=0;r<a;r++)n(r)},tokens:I}),r.a.createElement(N,{state:s,getMap:function(e){for(var t=e.target.files,a=t.length,n=function(e){var a=new FileReader,n=t[e];a.onloadend=function(){var e=new Image;e.src=a.result,R||(e.onload=function(){_(e)}),k((function(t){return[].concat(Object(p.a)(t),[e])}))},a.readAsDataURL(n)},r=0;r<a;r++)n(r)},maps:S,changeMap:function(e){var t=S[e.target.id[0]];_(t)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.configure({Auth:{mandatorySignIn:!0,region:u.REGION,userPoolId:u.USER_POOL_ID,identityPoolId:u.IDENTITY_POOL_ID,userPoolWebClientId:u.APP_CLIENT_ID},Storage:{region:i.REGION,bucket:i.BUCKET,identityPoolId:u.IDENTITY_POOL_ID},API:{endpoints:[{name:"gameboard",endpoint:s.URL,region:s.REGION}]}}),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},97:function(e,t,a){e.exports=a(151)}},[[97,1,2]]]);
//# sourceMappingURL=main.329eb35b.chunk.js.map